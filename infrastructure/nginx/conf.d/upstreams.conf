############################################################################
# NGINX Upstream Definitions
# Container Targets for Zentoria Personal Edition
# Updated: 2026-01-16
############################################################################

# Frontend Service (Container 400)
upstream zentoria_frontend {
    zone zentoria_frontend 64k;
    server zentoria-frontend:3000 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Backend API Service (Container 401)
upstream zentoria_backend {
    zone zentoria_backend 64k;
    server zentoria-backend:4000 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Backend WebSocket Service (Container 401)
upstream zentoria_backend_ws {
    zone zentoria_backend_ws 64k;
    server zentoria-backend:4001 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# N8N Automation (Container 402)
upstream zentoria_n8n {
    zone zentoria_n8n 64k;
    server zentoria-n8n:5678 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# HashiCorp Vault (Container 403)
upstream zentoria_vault {
    zone zentoria_vault 64k;
    server zentoria-vault:8200 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# AI Services (Container 405)
upstream zentoria_ai {
    zone zentoria_ai 64k;
    server zentoria-ai:5000 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

upstream zentoria_ollama {
    zone zentoria_ollama 64k;
    server zentoria-ai:11434 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Observability Stack (Container 406)
upstream zentoria_logs {
    zone zentoria_logs 64k;
    server zentoria-logs:3001 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

upstream zentoria_prometheus {
    zone zentoria_prometheus 64k;
    server zentoria-logs:9090 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# MinIO S3 Storage (Container 407)
upstream zentoria_minio_api {
    zone zentoria_minio_api 64k;
    server zentoria-files:9000 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

upstream zentoria_minio_ui {
    zone zentoria_minio_ui 64k;
    server zentoria-files:9001 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Keycloak Authentication (Container 409)
upstream zentoria_auth {
    zone zentoria_auth 64k;
    server zentoria-auth:9000 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Redis Commander (Container 410)
upstream zentoria_redis {
    zone zentoria_redis 64k;
    server zentoria-redis:8081 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# OCR Service (Container 412)
upstream zentoria_ocr {
    zone zentoria_ocr 64k;
    server zentoria-ocr:8000 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Voice/Audio Processing (Container 413)
upstream zentoria_voice {
    zone zentoria_voice 64k;
    server zentoria-voice:9300 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# Documentation & Swagger (Container 418)
upstream zentoria_docs {
    zone zentoria_docs 64k;
    server zentoria-docs:3002 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

upstream zentoria_swagger {
    zone zentoria_swagger 64k;
    server zentoria-docs:8080 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

# RAG & Vector Database (Container 419)
upstream zentoria_embeddings {
    zone zentoria_embeddings 64k;
    server zentoria-embeddings:8100 max_fails=3 fail_timeout=10s;
    keepalive 32;
}

upstream zentoria_qdrant {
    zone zentoria_qdrant 64k;
    server zentoria-embeddings:6333 max_fails=3 fail_timeout=10s;
    keepalive 32;
}
